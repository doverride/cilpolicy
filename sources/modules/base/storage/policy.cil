(typeattribute storage_unconfined_subj_type)

(block fixed_disk
	(blockinherit dev_storage_obj_blk))

(block fuse_storage
	(blockinherit dev_storage_obj_blk))

(block removable_storage
	(blockinherit dev_storage_obj_blk))

(block scsi_generic
	(blockinherit dev_storage_obj_blk))

(typeattribute storage_can_read_fixed_disk)
(typeattribute storage_can_not_read_fixed_disk_or_storage_unconfined_subj_type)

(typeattributeset storage_can_not_read_fixed_disk_or_storage_unconfined_subj_type
	(not (storage_can_read_fixed_disk storage_unconfined_subj_type)))

(neverallow storage_can_not_read_fixed_disk_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (read)))
(neverallow storage_can_not_read_fixed_disk_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (read)))

(typeattribute storage_can_write_fixed_disk)
(typeattribute storage_can_not_write_fixed_disk_or_storage_unconfined_subj_type)

(typeattributeset storage_can_not_write_fixed_disk_or_storage_unconfined_subj_type
	(not (storage_can_write_fixed_disk storage_unconfined_subj_type)))

(neverallow storage_can_not_write_fixed_disk_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (append write)))
(neverallow storage_can_not_write_fixed_disk_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (append write)))

(typeattribute storage_can_read_scsi_generic)
(typeattribute storage_can_not_read_scsi_generic_or_storage_unconfined_subj_type)

(typeattributeset storage_can_not_read_scsi_generic_or_storage_unconfined_subj_type
	(not (storage_can_read_scsi_generic storage_unconfined_subj_type)))

(neverallow storage_can_not_read_scsi_generic_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (read)))

(typeattribute storage_can_write_scsi_generic)
(typeattribute storage_can_not_write_scsi_generic_or_storage_unconfined_subj_type)

(typeattributeset storage_can_not_write_scsi_generic_or_storage_unconfined_subj_type
	(not (storage_can_write_scsi_generic storage_unconfined_subj_type)))

(neverallow storage_can_not_write_scsi_generic_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (append write)))

(allow storage_unconfined_subj_type fixed_disk.storage_dev all_chr_file_perms_except_mounton_and_execmod)
(allow storage_unconfined_subj_type fixed_disk.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type fuse_storage.storage_dev all_chr_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type removable_storage.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type scsi_generic.storage_dev all_chr_file_perms_except_mounton_and_execmod)
